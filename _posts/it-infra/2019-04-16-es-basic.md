---
title: "[Infra] 엘라스틱서치(ElasticsSearch) 간단요약 " 
categories:
  - it-infra
tags:
  - it-infra
use_math: true
toc: true
toc_label: "My Table of Contents"
toc_icon: "cog"
sidebar:
  title: "AI Machine Learning"
  nav: sidebar-contents
---

# 엘라스틱서치(ElasticsSearch) 간단요약

## 1. 멀티 테넌시(Multi Tenancy)

관계형 디비에서 다른 데이터베이스의 데이터를 검색하려면 별도의 컨넥션을 생성해야하는 것과 달리 
엘라스틱서치에서는 데이터를 검색할 때 서로 다른 인덱스의 데이터를 바로 하나의 질의로 묶어서 검색하고 
여러 검색 결과를 하나의 출력으로 도출 할 수 있다. 이를 멀티 테넌시(Multi Tenancy)라고 한다.

관계형DB | 엘라스틱서치
-------------|---------
데이터베이스(database) | 인덱스(index)
테이블(table) | 타입(type)
열(row) | 도큐먼트(document)
행(column) | 필드(field)
스키마(schema) | 매핑(Mapping)

HTTP Method | CRUD | SQL
-----------|--------|-----
GET | Read | Select
PUT | Update | Update
POST | Create | Insert
DELETE | Delete | Delete


## 2. 유닉스에서 엘라스틱서치의 REST API를 이용한 curl 명령

```bash
curl -X{메소드} http://host:port/{인덱스}/{타입}/{도큐먼트 id} -d ‘{데이터}’ 
```

## 3. 엘라스틱 서치 템플릿(template) 확인 

엘라스틱 서치의 템플릿(template)은 RDBMS의 스키마와 같은 것이라고 생각하면 편하다. 

* 사용법

```bash
curl 'http://localhost:9200/{인덱스명}/_mapping?pretty'
```

* 사용 예(abcde라는 인덱스의 템플릿을  싶을때)

```bash
curl 'http://localhost:9200/abcde/_mapping?pretty'
```

* abcd 라는 인덱스 확인

```bash
curl localhost:9200/abcd/
```

* abcd 라는 인덱스 삭제

```bash
curl -XDELETE http://localhost:9200/abcd
```

* 초기에 템플릿 포함해서 abcd 라는 인덱스 생성
* 쉘 스크립트를 하나 만드는게 좋은듯

```bash
curl -XPUT http://localhost:9200/abcd/ -d '
{
  "order": 0,
  "template": "abcd",
  "setting": {},
  "mapping": {
      "_default_": {
          "properties": {
                  
                  실제 필드들~~~~
          
          }
      }
   }
}'
```

## 4. 메타 필드(Meta Fields)

메타필드 | 설명
--------|------
\_index | 해당 문서가 속한 인덱스의 이름을 담고 있다.
\_type | 해당 문서가 속한 매핑의 타입 정보를 담고 있다. 
\_id | 문서를 식별하는 유일한 키값. 한 인덱스에서 색인된 문서마다 서로 다른 키값을 가짐. RDB 에서의 PRIMARY KEY라고 보면 될 듯. 이 값은 int, long, 상관없이 무조건 string으로 저장된다.
\_uid | 특수 목적 식별키. "#" 태그를 이용해 \_type과 \_id 값을 조합해 사용함. 하지만 내부적으로 사용되기 때문에 조회시 검색되진 않음. 
\_source | 문서의 원본 데이터를 제공함.
\_all | 색인에 사용된 모든 필드의 정보를 가진 메타 필드.
\_routing | 특정 문서를 특정 샤드에 저장하기 위해 사용하는 메타필드. 
